(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{111:function(t,e,a){},144:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),s=a(9),o=a.n(s);a(111),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,d,r=a(26),u=a(48),l=a.n(u),j=a(190),b=a(191),f=a(192),p=a(181),O=a(147),h=a(146),m=a(193),k=a(194),L=a(94),g=a.n(L),x=a(13),S=a(14),v=a(199),I=a(196),C=a(87),T=a.n(C).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.1/",headers:{"API-KEY":"528fa1c0-cacc-47ff-ae93-32ce73ccde7f"}}),y=function(){return T.get("todo-lists")},A=function(t){return T.post("todo-lists",{title:t})},_=function(t){return T.delete("todo-lists/".concat(t))},w=function(t,e){return T.put("todo-lists/".concat(t),{title:e})};!function(t){t[t.New=0]="New",t[t.inProgress=1]="inProgress",t[t.Completed=2]="Completed",t[t.draft=3]="draft"}(c||(c={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(d||(d={}));var E,D=function(t){return T.get("todo-lists/".concat(t,"/tasks"))},P=function(t,e){return T.post("todo-lists/".concat(t,"/tasks"),{title:e})},N=function(t,e){return T.delete("todo-lists/".concat(t,"/tasks/").concat(e))},F=function(t,e,a){return T.put("todo-lists/".concat(t,"/tasks/").concat(e),Object(S.a)({},a))},V=function(t){return T.post("auth/login",Object(S.a)({},t))},z=function(){return T.delete("auth/login")},M=function(){return T.get("/auth/me")},U=function(t,e){t.messages.length?e(J({error:t.messages[0]})):e(J({error:"some server error"})),e(q({status:"failed"}))},H=function(t,e){e(J({error:t.message?t.message:"Some error occurred"})),e(q({status:"idle"}))},K=a(31),G=Object(K.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedIn:function(t,e){t.isLoggedIn=e.payload.isLoggedIn}}}),Z=G.reducer,R=G.actions.setIsLoggedIn,W=Object(K.b)({name:"app",initialState:{status:"idle",error:null,initialized:!1},reducers:{setAppStatus:function(t,e){t.status=e.payload.status},setAppError:function(t,e){t.error=e.payload.error},setAppInitialized:function(t,e){t.initialized=e.payload.initialized}}}),B=W.reducer,Y=W.actions,q=Y.setAppStatus,J=Y.setAppError,$=Y.setAppInitialized,X=a(4);function Q(t){return Object(X.jsx)(I.a,Object(S.a)({elevation:6,variant:"filled"},t))}function tt(){var t=Object(x.b)(),e=function(e,a){"clickaway"!==a&&t(J({error:null}))},a=Object(x.c)((function(t){return t.app.error})),n=null!==a;return Object(X.jsx)(v.a,{open:n,autoHideDuration:3e3,onClose:e,children:Object(X.jsx)(Q,{onClose:e,severity:"error",children:a})})}!function(t){t.ADD_NEW_TODOLIST="todoList/todolists-actions/add-new-todolist",t.CHANGE_TODOLIST_FILTER_VALUE="todoList/todolists-actions/change-todolist-filter-value",t.CHANGE_TODOLIST_ENTITY_STATUS_VALUE="todoList/todolists-actions/change-todolist-entity-status-value",t.CHANGE_TODOLIST_TITLE="todoList/todolists-actions/change-todolist-title",t.DELETE_TODOLIST="todoList/todolists-actions/delete-todolist",t.GET_TODOLISTS="todoList/todolists-actions/get-todolist"}(E||(E={}));var et,at=Object(K.b)({name:"todoLists",initialState:[],reducers:{getTodoListsAC:function(t,e){return e.payload.todolists.map((function(t){return Object(S.a)(Object(S.a)({},t),{},{filter:"all",entityStatus:"new"})}))},addTodoListAC:function(t,e){t.unshift(Object(S.a)(Object(S.a)({},e.payload.todoList),{},{filter:"all",entityStatus:"new"}))},changeTodoListFilterValueAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListID}));a>-1&&(t[a].filter=e.payload.filter)},changeTodoListTitleAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListId}));a>-1&&(t[a].title=e.payload.title)},deleteTodoListAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListId}));a>-1&&t.splice(a,1)},changeTodoListEntityStatusAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListId}));a>-1&&(t[a].entityStatus=e.payload.entityStatus)}}}),nt=at.reducer,it=at.actions,st=it.getTodoListsAC,ot=it.addTodoListAC,ct=it.changeTodoListFilterValueAC,dt=it.changeTodoListTitleAC,rt=it.deleteTodoListAC,ut=it.changeTodoListEntityStatusAC,lt=a(187),jt=a(145),bt=a(51),ft=a(195),pt=a(184),Ot=i.a.memo((function(t){var e=t.addTodoList,a=(t.disabled,t.todoListOrAppStatus),i=t.kindForm,s=(Object(r.a)(t,["addTodoList","disabled","todoListOrAppStatus","kindForm"]),Object(n.useState)("")),o=Object(bt.a)(s,2),c=o[0],d=o[1],u=Object(n.useState)(""),l=Object(bt.a)(u,2),j=l[0],b=l[1],f=function(){c.trim()?(e(c),d(""),b("")):b("Incorrect value")},O="addition"===a&&"task"===i||"addition"===a&&"todoList"===i||"deletion"===a;return Object(X.jsxs)("div",{children:[Object(X.jsx)(ft.a,{variant:"outlined",label:"Title",value:c,onChange:function(t){d(t.currentTarget.value),b("")},onKeyPress:function(t){return"Enter"===t.key&&f()},error:!!j,helperText:j,disabled:O}),Object(X.jsx)(p.a,{color:"primary",onClick:f,disabled:O,children:Object(X.jsx)(pt.a,{})})]})})),ht=a(69),mt=a.n(ht),kt=i.a.memo((function(t){var e=t.title,a=t.changeValueEditableSpan,i=t.taskStatus,s=(Object(r.a)(t,["title","changeValueEditableSpan","taskStatus"]),Object(n.useState)(!1)),o=Object(bt.a)(s,2),c=o[0],d=o[1],u=Object(n.useState)(""),l=Object(bt.a)(u,2),j=l[0],b=l[1];return c?Object(X.jsx)(ft.a,{autoFocus:!0,onBlur:function(){d(!1),a(j)},value:j,onChange:function(t){return b(t.currentTarget.value)},disabled:"deletion"===i,className:mt.a.textFieldContainer}):Object(X.jsx)("span",{onDoubleClick:function(){d(!0),b(e)},className:mt.a.outputSpanContainer,children:e})})),Lt=a(186),gt=a(185);!function(t){t.DELETE_TASK="todoList/tasks-reducer/delete-task",t.ADD_TASK="todoList/tasks-reducer/add-task",t.UPDATE_TASK="todoList/tasks-reducer/update-task",t.SET_TASKS="todoList/tasks-reducer/set-tasks",t.CHANGE_TASK_STATUS="todoList/tasks-reducer/change-task-status"}(et||(et={}));var xt=Object(K.b)({name:"tasks",initialState:{},reducers:{deleteTaskAC:function(t,e){var a=t[e.payload.todoListId].findIndex((function(t){return t.id===e.payload.taskId}));a>-1&&t[e.payload.todoListId].splice(a,1)},addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(Object(S.a)(Object(S.a)({},e.payload.task),{},{taskStatus:"new"}))},updateTaskAC:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n]=Object(S.a)(Object(S.a)({},a[n]),e.payload.apiModel))},setTasksAC:function(t,e){t[e.payload.todoListId]=e.payload.tasks.map((function(t){return Object(S.a)(Object(S.a)({},t),{},{taskStatus:"new"})}))},changeTaskStatus:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n].taskStatus=e.payload.taskStatus)}},extraReducers:function(t){t.addCase(ot,(function(t,e){t[e.payload.todoList.id]=[]})),t.addCase(st,(function(t,e){e.payload.todolists.forEach((function(e){t[e.id]=[]}))})),t.addCase(rt,(function(t,e){delete t[e.payload.todoListId]}))}}),St=xt.reducer,vt=xt.actions,It=vt.deleteTaskAC,Ct=vt.addTaskAC,Tt=vt.updateTaskAC,yt=vt.setTasksAC,At=vt.changeTaskStatus,_t=function(t,e,a){return function(n,i){n(q({status:"loading"})),n(At({todoListId:t,taskId:e,taskStatus:"edition"}));var s=i().tasks[t].find((function(t){return t.id===e}));if(s){var o=Object(S.a)({title:s.title,description:s.description,completed:s.completed,status:s.status,priority:s.priority,startDate:s.startDate,deadline:s.deadline},a);F(t,e,o).then((function(a){0===a.data.resultCode?(n(Tt({taskId:e,todoListId:t,apiModel:o})),n(At({todoListId:t,taskId:e,taskStatus:"succeeded"})),n(q({status:"succeeded"}))):U(a.data,n)})).catch((function(t){H(t,n)}))}else console.warn("Task not found in the state")}},wt=a(197),Et=a(70),Dt=a.n(Et),Pt=i.a.memo((function(t){var e=t.todoListID,a=t.taskID,i=t.task,s=(Object(r.a)(t,["todoListID","taskID","task"]),Object(x.b)()),o=Object(n.useCallback)((function(t){var n=t.currentTarget.checked;s(_t(e,a,{status:n?c.Completed:c.New}))}),[s,a,e]),d=Object(n.useCallback)((function(){return s((t=e,n=a,function(e){e(At({todoListId:t,taskId:n,taskStatus:"deletion"})),e(q({status:"loading"})),N(t,n).then((function(a){e(It({taskId:n,todoListId:t})),e(q({status:"succeeded"}))}))}));var t,n}),[s,a,e]),u=Object(n.useCallback)((function(t){s(_t(e,a,{title:t}))}),[s,a,e]);return Object(X.jsxs)("li",{className:"".concat(Dt.a.taskPosition," ").concat(i.status===c.Completed?Dt.a.taskDone:""),children:[Object(X.jsx)(wt.a,{checked:i.status===c.Completed,onChange:o,disabled:"deletion"===i.taskStatus||"edition"===i.taskStatus}),Object(X.jsx)(kt,{title:i.title,changeValueEditableSpan:u,taskStatus:i.taskStatus}),Object(X.jsx)(p.a,{"aria-label":"delete",onClick:d,disabled:"deletion"===i.taskStatus,children:Object(X.jsx)(gt.a,{fontSize:"small"})})]},a)})),Nt=i.a.memo((function(t){var e=t.todoList,a=t.demo,i=void 0!==a&&a,s=(Object(r.a)(t,["todoList","demo"]),Object(x.b)());Object(n.useEffect)((function(){var t;i||s((t=e.id,function(e){e(q({status:"loading"})),D(t).then((function(a){e(yt({todoListId:t,tasks:a.data.items})),e(q({status:"succeeded"}))}))}))}),[s,e.id]);var o=Object(x.c)((function(t){return t.tasks}))[e.id];"active"===e.filter&&(o=o.filter((function(t){return t.status===c.New}))),"completed"===e.filter&&(o=o.filter((function(t){return t.status===c.Completed})));var d=Object(n.useCallback)((function(){return s((t=e.id,function(e){e(q({status:"loading"})),e(ut({todoListId:t,entityStatus:"deletion"})),_(t).then((function(a){e(rt({todoListId:t})),e(q({status:"succeeded"}))}))}));var t}),[s,e.id]),u=Object(n.useCallback)((function(t){return s(function(t,e){return function(a){a(q({status:"loading"})),a(ut({todoListId:t,entityStatus:"addition"})),P(t,e).then((function(e){0===e.data.resultCode?(a(Ct({task:e.data.data.item})),a(q({status:"succeeded"})),a(ut({entityStatus:"succeeded",todoListId:t}))):U(e.data,a)})).catch((function(t){H(t,a)})).finally((function(){a(ut({entityStatus:"succeeded",todoListId:t}))}))}}(e.id,t))}),[s,e.id]),l=Object(n.useCallback)((function(t){return s((a=e.id,n=t,function(t){w(a,n).then((function(e){return t(dt({todoListId:a,title:n}))}))}));var a,n}),[s,e.id]),j=Object(n.useCallback)((function(){return s(ct({todoListID:e.id,filter:"all"}))}),[s,e.id]),b=Object(n.useCallback)((function(){return s(ct({todoListID:e.id,filter:"active"}))}),[s,e.id]),f=Object(n.useCallback)((function(){return s(ct({todoListID:e.id,filter:"completed"}))}),[s,e.id]);return Object(X.jsxs)("div",{children:[Object(X.jsxs)("h3",{children:[Object(X.jsx)(kt,{title:e.title,changeValueEditableSpan:l,taskStatus:e.entityStatus}),Object(X.jsx)(h.a,{onClick:d,variant:"contained",color:"secondary",startIcon:Object(X.jsx)(gt.a,{}),size:"small",style:{margin:"0 10px"},disabled:"deletion"===e.entityStatus,children:"Delete"})]}),Object(X.jsx)(Ot,{addTodoList:u,todoListOrAppStatus:e.entityStatus,kindForm:"task"}),Object(X.jsx)("ul",{style:{listStyle:"none"},children:o.map((function(t){return Object(X.jsx)(Pt,{todoListID:e.id,taskID:t.id,task:t},t.id)}))}),Object(X.jsx)("div",{children:Object(X.jsxs)(Lt.a,{variant:"contained",color:"primary",children:[Object(X.jsx)(h.a,{onClick:j,children:"All"}),Object(X.jsx)(h.a,{onClick:b,children:"Active"}),Object(X.jsx)(h.a,{onClick:f,children:"Completed"})]})})]})})),Ft=a(16),Vt=i.a.memo((function(t){var e=t.demo,a=void 0!==e&&e,i=(Object(r.a)(t,["demo"]),Object(x.c)((function(t){return t.todoLists}))),s=Object(x.c)((function(t){return t.app.status})),o=Object(x.c)((function(t){return t.auth.isLoggedIn})),c=Object(x.b)();Object(n.useEffect)((function(){!a&&o&&c((function(t){t(q({status:"loading"})),y().then((function(e){t(st({todolists:e.data})),t(q({status:"succeeded"}))})).catch((function(e){H(e,t)}))}))}),[c]);var d=Object(n.useCallback)((function(t){c(function(t){return function(e){e(q({status:"addition"})),A(t).then((function(t){0===t.data.resultCode?(e(ot({todoList:t.data.data.item})),e(q({status:"succeeded"}))):U(t.data,e)})).catch((function(t){H(t,e)}))}}(t))}),[c]);return o?Object(X.jsxs)("div",{children:[Object(X.jsx)(lt.a,{container:!0,style:{padding:"10px 0"},children:Object(X.jsx)(Ot,{addTodoList:d,todoListOrAppStatus:s,kindForm:"todoList"})}),Object(X.jsx)(lt.a,{container:!0,spacing:4,children:i.map((function(t){return Object(X.jsx)(lt.a,{item:!0,children:Object(X.jsx)(jt.a,{style:{padding:"10px"},children:Object(X.jsx)(Nt,{todoList:t,demo:a})})},t.id)}))})]}):Object(X.jsx)(Ft.a,{to:"/login"})})),zt=a(58),Mt=a(182),Ut=a(183),Ht=a(188),Kt=a(189),Gt=a(95),Zt=a(73),Rt=a.n(Zt),Wt=function(){var t=Object(x.b)(),e=Object(x.c)((function(t){return t.auth.isLoggedIn})),a=Object(Gt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){return t.password?t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)?void 0:{email:"Invalid email address"}:{email:"email is required"}:{password:"password is required"}},onSubmit:function(e){var a;t((a=e,function(t){t(q({status:"loading"})),V(a).then((function(e){0===e.data.resultCode?(t(q({status:"succeeded"})),t(R({isLoggedIn:!0}))):U(e.data,t)})).catch((function(e){H(e,t)}))}))}}),n=!a.values.email||!a.values.password;return e?Object(X.jsx)(Ft.a,{to:"/"}):Object(X.jsxs)(lt.a,{container:!0,justify:"center",children:[Object(X.jsx)(lt.a,{item:!0,children:Object(X.jsx)("form",{onSubmit:a.handleSubmit,children:Object(X.jsxs)(Mt.a,{children:[Object(X.jsxs)(Ut.a,{style:{textAlign:"center"},children:[Object(X.jsxs)("p",{children:["To log in get registered",Object(X.jsx)("a",{href:"https://social-network.samuraijs.com/",target:"_blank",children:" here"})]}),Object(X.jsx)("p",{children:"or use common test account credentials:"}),Object(X.jsx)("p",{children:"Email: free@samuraijs.com"}),Object(X.jsx)("p",{children:"Password: free"})]}),Object(X.jsxs)(Ht.a,{children:[Object(X.jsx)(ft.a,Object(S.a)({label:"Email",margin:"normal"},a.getFieldProps("email"))),Object(X.jsx)("div",{className:Rt.a.promptValidation,children:a.errors.email?a.errors.email:""}),Object(X.jsx)(ft.a,Object(S.a)({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),Object(X.jsx)("div",{className:Rt.a.promptValidation,children:a.errors.password?a.errors.password:""}),Object(X.jsx)(Kt.a,{label:"Remember me",control:Object(X.jsx)(wt.a,Object(S.a)(Object(S.a)({},a.getFieldProps("rememberMe")),{},{checked:a.values.rememberMe}))}),Object(X.jsx)(h.a,{disabled:n,type:"submit",variant:"contained",color:"primary",children:"Login"})]})]})})}),Object(X.jsx)(tt,{})]})};var Bt=function(t){var e=t.demo,a=void 0!==e&&e,i=(Object(r.a)(t,["demo"]),Object(x.c)((function(t){return t.app.status}))),s=Object(x.c)((function(t){return t.app.initialized})),o=Object(x.c)((function(t){return t.auth.isLoggedIn})),c=Object(x.b)();Object(n.useEffect)((function(){c((function(t){M().then((function(e){0===e.data.resultCode?t(R({isLoggedIn:!0})):U(e.data,t),t($({initialized:!0}))})).catch((function(e){H(e,t)}))}))}),[]);var d=Object(n.useCallback)((function(){c((function(t){t(q({status:"loading"})),z().then((function(e){0===e.data.resultCode?(t(q({status:"succeeded"})),t(R({isLoggedIn:!1}))):U(e.data,t)})).catch((function(e){H(e,t)}))}))}),[]);return s?Object(X.jsx)(zt.a,{children:Object(X.jsxs)("div",{className:l.a.app,children:[Object(X.jsxs)(b.a,{position:"static",className:l.a.headerPosition,children:[Object(X.jsxs)(f.a,{style:{justifyContent:"space-between"},children:[Object(X.jsx)(p.a,{edge:"start",color:"inherit","aria-label":"menu",children:Object(X.jsx)(g.a,{})}),Object(X.jsx)(O.a,{variant:"h6",children:"TodoLists"}),o&&Object(X.jsx)(h.a,{color:"inherit",onClick:d,children:"Log out"})]}),"loading"===i&&Object(X.jsx)(m.a,{className:l.a.linearProgress})]}),Object(X.jsx)(tt,{}),Object(X.jsx)(k.a,{fixed:!0,children:Object(X.jsxs)(Ft.d,{children:[Object(X.jsx)(Ft.b,{exact:!0,path:"/",render:function(){return Object(X.jsx)(Vt,{demo:a})}}),Object(X.jsx)(Ft.b,{path:"/login",render:function(){return Object(X.jsx)(Wt,{})}}),Object(X.jsx)(Ft.b,{path:"*",render:function(){return Object(X.jsx)("h1",{children:"PAGE NOT FOUND"})}})]})})]})}):Object(X.jsx)("div",{className:l.a.previewCircularProgress,children:Object(X.jsx)(j.a,{color:"secondary"})})},Yt=a(27),qt=a(52),Jt=Object(Yt.b)({todoLists:nt,tasks:St,app:B,auth:Z}),$t=Object(K.a)({reducer:Jt,middleware:function(t){return t().prepend(qt.a)}});o.a.render(Object(X.jsx)(x.a,{store:$t,children:Object(X.jsx)(Bt,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},48:function(t,e,a){t.exports={isDone:"App_isDone__cFwf-",app:"App_app__3M1zD",headerPosition:"App_headerPosition__3VhUp",linearProgress:"App_linearProgress__2Okxf",previewCircularProgress:"App_previewCircularProgress__1pFTr"}},69:function(t,e,a){t.exports={outputSpanContainer:"EditableSpan_outputSpanContainer__3AcMO",textFieldContainer:"EditableSpan_textFieldContainer__3Z4MY"}},70:function(t,e,a){t.exports={taskPosition:"Task_taskPosition__1dZmT",taskDone:"Task_taskDone__1j_LX"}},73:function(t,e,a){t.exports={promptValidation:"Login_promptValidation__3PrWS"}}},[[144,1,2]]]);
//# sourceMappingURL=main.a6026ef0.chunk.js.map