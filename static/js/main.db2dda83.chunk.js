(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{111:function(t,e,a){},144:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),s=a(9),o=a.n(s);a(111),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,d,r=a(26),u=a(48),l=a.n(u),j=a(190),b=a(191),f=a(192),p=a(181),O=a(147),h=a(146),m=a(193),x=a(194),k=a(94),g=a.n(k),L=a(13),v=a(14),C=a(199),y=a(196),I=a(87),S=a.n(I).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.1/",headers:{"API-KEY":"528fa1c0-cacc-47ff-ae93-32ce73ccde7f"}}),A=function(){return S.get("todo-lists")},T=function(t){return S.post("todo-lists",{title:t})},w=function(t){return S.delete("todo-lists/".concat(t))},_=function(t,e){return S.put("todo-lists/".concat(t),{title:e})},P=function(t){return S.get("todo-lists/".concat(t,"/tasks"))},D=function(t,e){return S.post("todo-lists/".concat(t,"/tasks"),{title:e})},E=function(t,e){return S.delete("todo-lists/".concat(t,"/tasks/").concat(e))},F=function(t,e,a){return S.put("todo-lists/".concat(t,"/tasks/").concat(e),Object(v.a)({},a))},N=function(t){return S.post("auth/login",Object(v.a)({},t))},V=function(){return S.delete("auth/login")},z=function(){return S.get("/auth/me")};!function(t){t[t.New=0]="New",t[t.inProgress=1]="inProgress",t[t.Completed=2]="Completed",t[t.draft=3]="draft"}(c||(c={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(d||(d={}));var M=function(t,e){t.messages.length?e(Y({error:t.messages[0]})):e(Y({error:"some server error"})),e(K({status:"failed"}))},U=function(t,e){e(Y({error:t.message?t.message:"Some error occurred"})),e(K({status:"idle"}))},Z=a(31),B=Object(Z.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedIn:function(t,e){t.isLoggedIn=e.payload.isLoggedIn}}}),H=B.reducer,R=B.actions.setIsLoggedIn,W=Object(Z.b)({name:"app",initialState:{status:"idle",error:null,initialized:!1},reducers:{setAppStatus:function(t,e){t.status=e.payload.status},setAppError:function(t,e){t.error=e.payload.error},setAppInitialized:function(t,e){t.initialized=e.payload.initialized}}}),q=W.reducer,J=W.actions,K=J.setAppStatus,Y=J.setAppError,$=J.setAppInitialized,G=a(4);function X(t){return Object(G.jsx)(y.a,Object(v.a)({elevation:6,variant:"filled"},t))}function Q(){var t=Object(L.b)(),e=function(e,a){"clickaway"!==a&&t(Y({error:null}))},a=Object(L.c)((function(t){return t.app.error})),n=null!==a;return Object(G.jsx)(C.a,{open:n,autoHideDuration:3e3,onClose:e,children:Object(G.jsx)(X,{onClose:e,severity:"error",children:a})})}var tt=Object(Z.b)({name:"todoLists",initialState:[],reducers:{getTodoListsAC:function(t,e){return e.payload.todolists.map((function(t){return Object(v.a)(Object(v.a)({},t),{},{filter:"all",entityStatus:"new"})}))},addTodoListAC:function(t,e){t.unshift(Object(v.a)(Object(v.a)({},e.payload.todoList),{},{filter:"all",entityStatus:"new"}))},changeTodoListFilterValueAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListID}));a>-1&&(t[a].filter=e.payload.filter)},changeTodoListTitleAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListId}));a>-1&&(t[a].title=e.payload.title)},deleteTodoListAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListId}));a>-1&&t.splice(a,1)},changeTodoListEntityStatusAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListId}));a>-1&&(t[a].entityStatus=e.payload.entityStatus)}}}),et=tt.reducer,at=tt.actions,nt=at.getTodoListsAC,it=at.addTodoListAC,st=at.changeTodoListFilterValueAC,ot=at.changeTodoListTitleAC,ct=at.deleteTodoListAC,dt=at.changeTodoListEntityStatusAC,rt=a(187),ut=a(145),lt=a(51),jt=a(195),bt=a(184),ft=i.a.memo((function(t){var e=t.addTodoList,a=(t.disabled,t.todoListOrAppStatus),i=t.kindForm,s=(Object(r.a)(t,["addTodoList","disabled","todoListOrAppStatus","kindForm"]),Object(n.useState)("")),o=Object(lt.a)(s,2),c=o[0],d=o[1],u=Object(n.useState)(""),l=Object(lt.a)(u,2),j=l[0],b=l[1],f=function(){c.trim()?(e(c),d(""),b("")):b("Incorrect value")},O="addition"===a&&"task"===i||"addition"===a&&"todoList"===i||"deletion"===a;return Object(G.jsxs)("div",{children:[Object(G.jsx)(jt.a,{variant:"outlined",label:"Title",value:c,onChange:function(t){d(t.currentTarget.value),b("")},onKeyPress:function(t){return"Enter"===t.key&&f()},error:!!j,helperText:j,disabled:O}),Object(G.jsx)(p.a,{color:"primary",onClick:f,disabled:O,children:Object(G.jsx)(bt.a,{})})]})})),pt=a(69),Ot=a.n(pt),ht=i.a.memo((function(t){var e=t.title,a=t.changeValueEditableSpan,i=t.taskStatus,s=(Object(r.a)(t,["title","changeValueEditableSpan","taskStatus"]),Object(n.useState)(!1)),o=Object(lt.a)(s,2),c=o[0],d=o[1],u=Object(n.useState)(""),l=Object(lt.a)(u,2),j=l[0],b=l[1];return c?Object(G.jsx)(jt.a,{autoFocus:!0,onBlur:function(){d(!1),a(j)},value:j,onChange:function(t){return b(t.currentTarget.value)},disabled:"deletion"===i,className:Ot.a.textFieldContainer}):Object(G.jsx)("span",{onDoubleClick:function(){d(!0),b(e)},className:Ot.a.outputSpanContainer,children:e})})),mt=a(186),xt=a(185),kt=Object(Z.b)({name:"tasks",initialState:{},reducers:{deleteTaskAC:function(t,e){var a=t[e.payload.todoListId].findIndex((function(t){return t.id===e.payload.taskId}));a>-1&&t[e.payload.todoListId].splice(a,1)},addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(Object(v.a)(Object(v.a)({},e.payload.task),{},{taskStatus:"new"}))},updateTaskAC:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n]=Object(v.a)(Object(v.a)({},a[n]),e.payload.apiModel))},setTasksAC:function(t,e){t[e.payload.todoListId]=e.payload.tasks.map((function(t){return Object(v.a)(Object(v.a)({},t),{},{taskStatus:"new"})}))},changeTaskStatus:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n].taskStatus=e.payload.taskStatus)}},extraReducers:function(t){t.addCase(it,(function(t,e){t[e.payload.todoList.id]=[]})),t.addCase(nt,(function(t,e){e.payload.todolists.forEach((function(e){t[e.id]=[]}))})),t.addCase(ct,(function(t,e){delete t[e.payload.todoListId]}))}}),gt=kt.reducer,Lt=kt.actions,vt=Lt.deleteTaskAC,Ct=Lt.addTaskAC,yt=Lt.updateTaskAC,It=Lt.setTasksAC,St=Lt.changeTaskStatus,At=function(t,e,a){return function(n,i){n(K({status:"loading"})),n(St({todoListId:t,taskId:e,taskStatus:"edition"}));var s=i().tasks[t].find((function(t){return t.id===e}));if(s){var o=Object(v.a)({title:s.title,description:s.description,completed:s.completed,status:s.status,priority:s.priority,startDate:s.startDate,deadline:s.deadline},a);F(t,e,o).then((function(a){0===a.data.resultCode?(n(yt({taskId:e,todoListId:t,apiModel:o})),n(St({todoListId:t,taskId:e,taskStatus:"succeeded"})),n(K({status:"succeeded"}))):M(a.data,n)})).catch((function(t){U(t,n)}))}else console.warn("Task not found in the state")}},Tt=a(197),wt=a(70),_t=a.n(wt),Pt=i.a.memo((function(t){var e=t.todoListID,a=t.taskID,i=t.task,s=(Object(r.a)(t,["todoListID","taskID","task"]),Object(L.b)()),o=Object(n.useCallback)((function(t){var n=t.currentTarget.checked;s(At(e,a,{status:n?c.Completed:c.New}))}),[s,a,e]),d=Object(n.useCallback)((function(){return s((t=e,n=a,function(e){e(St({todoListId:t,taskId:n,taskStatus:"deletion"})),e(K({status:"loading"})),E(t,n).then((function(a){e(vt({taskId:n,todoListId:t})),e(K({status:"succeeded"}))}))}));var t,n}),[s,a,e]),u=Object(n.useCallback)((function(t){s(At(e,a,{title:t}))}),[s,a,e]);return Object(G.jsxs)("li",{className:"".concat(_t.a.taskPosition," ").concat(i.status===c.Completed?_t.a.taskDone:""),children:[Object(G.jsx)(Tt.a,{checked:i.status===c.Completed,onChange:o,disabled:"deletion"===i.taskStatus||"edition"===i.taskStatus}),Object(G.jsx)(ht,{title:i.title,changeValueEditableSpan:u,taskStatus:i.taskStatus}),Object(G.jsx)(p.a,{"aria-label":"delete",onClick:d,disabled:"deletion"===i.taskStatus,children:Object(G.jsx)(xt.a,{fontSize:"small"})})]},a)})),Dt=i.a.memo((function(t){var e=t.todoList,a=t.demo,i=void 0!==a&&a,s=(Object(r.a)(t,["todoList","demo"]),Object(L.b)());Object(n.useEffect)((function(){var t;i||s((t=e.id,function(e){e(K({status:"loading"})),P(t).then((function(a){e(It({todoListId:t,tasks:a.data.items})),e(K({status:"succeeded"}))}))}))}),[s,e.id]);var o=Object(L.c)((function(t){return t.tasks}))[e.id];"active"===e.filter&&(o=o.filter((function(t){return t.status===c.New}))),"completed"===e.filter&&(o=o.filter((function(t){return t.status===c.Completed})));var d=Object(n.useCallback)((function(){return s((t=e.id,function(e){e(K({status:"loading"})),e(dt({todoListId:t,entityStatus:"deletion"})),w(t).then((function(a){e(ct({todoListId:t})),e(K({status:"succeeded"}))}))}));var t}),[s,e.id]),u=Object(n.useCallback)((function(t){return s(function(t,e){return function(a){a(K({status:"loading"})),a(dt({todoListId:t,entityStatus:"addition"})),D(t,e).then((function(e){0===e.data.resultCode?(a(Ct({task:e.data.data.item})),a(K({status:"succeeded"})),a(dt({entityStatus:"succeeded",todoListId:t}))):M(e.data,a)})).catch((function(t){U(t,a)})).finally((function(){a(dt({entityStatus:"succeeded",todoListId:t}))}))}}(e.id,t))}),[s,e.id]),l=Object(n.useCallback)((function(t){return s((a=e.id,n=t,function(t){_(a,n).then((function(e){return t(ot({todoListId:a,title:n}))}))}));var a,n}),[s,e.id]),j=Object(n.useCallback)((function(){return s(st({todoListID:e.id,filter:"all"}))}),[s,e.id]),b=Object(n.useCallback)((function(){return s(st({todoListID:e.id,filter:"active"}))}),[s,e.id]),f=Object(n.useCallback)((function(){return s(st({todoListID:e.id,filter:"completed"}))}),[s,e.id]);return Object(G.jsxs)("div",{children:[Object(G.jsxs)("h3",{children:[Object(G.jsx)(ht,{title:e.title,changeValueEditableSpan:l,taskStatus:e.entityStatus}),Object(G.jsx)(h.a,{onClick:d,variant:"contained",color:"secondary",startIcon:Object(G.jsx)(xt.a,{}),size:"small",style:{margin:"0 10px"},disabled:"deletion"===e.entityStatus,children:"Delete"})]}),Object(G.jsx)(ft,{addTodoList:u,todoListOrAppStatus:e.entityStatus,kindForm:"task"}),Object(G.jsx)("ul",{style:{listStyle:"none"},children:o.map((function(t){return Object(G.jsx)(Pt,{todoListID:e.id,taskID:t.id,task:t},t.id)}))}),Object(G.jsx)("div",{children:Object(G.jsxs)(mt.a,{variant:"contained",color:"primary",children:[Object(G.jsx)(h.a,{onClick:j,children:"All"}),Object(G.jsx)(h.a,{onClick:b,children:"Active"}),Object(G.jsx)(h.a,{onClick:f,children:"Completed"})]})})]})})),Et=a(16),Ft=i.a.memo((function(t){var e=t.demo,a=void 0!==e&&e,i=(Object(r.a)(t,["demo"]),Object(L.c)((function(t){return t.todoLists}))),s=Object(L.c)((function(t){return t.app.status})),o=Object(L.c)((function(t){return t.auth.isLoggedIn})),c=Object(L.b)();Object(n.useEffect)((function(){!a&&o&&c((function(t){t(K({status:"loading"})),A().then((function(e){t(nt({todolists:e.data})),t(K({status:"succeeded"}))})).catch((function(e){U(e,t)}))}))}),[c]);var d=Object(n.useCallback)((function(t){c(function(t){return function(e){e(K({status:"addition"})),T(t).then((function(t){0===t.data.resultCode?(e(it({todoList:t.data.data.item})),e(K({status:"succeeded"}))):M(t.data,e)})).catch((function(t){U(t,e)}))}}(t))}),[c]);return o?Object(G.jsxs)("div",{children:[Object(G.jsx)(rt.a,{container:!0,style:{padding:"10px 0"},children:Object(G.jsx)(ft,{addTodoList:d,todoListOrAppStatus:s,kindForm:"todoList"})}),Object(G.jsx)(rt.a,{container:!0,spacing:4,children:i.map((function(t){return Object(G.jsx)(rt.a,{item:!0,children:Object(G.jsx)(ut.a,{style:{padding:"10px"},children:Object(G.jsx)(Dt,{todoList:t,demo:a})})},t.id)}))})]}):Object(G.jsx)(Et.a,{to:"/login"})})),Nt=a(58),Vt=a(182),zt=a(183),Mt=a(188),Ut=a(189),Zt=a(95),Bt=a(73),Ht=a.n(Bt),Rt=function(){var t=Object(L.b)(),e=Object(L.c)((function(t){return t.auth.isLoggedIn})),a=Object(Zt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){return t.password?t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)?void 0:{email:"Invalid email address"}:{email:"email is required"}:{password:"password is required"}},onSubmit:function(e){var a;t((a=e,function(t){t(K({status:"loading"})),N(a).then((function(e){0===e.data.resultCode?(t(K({status:"succeeded"})),t(R({isLoggedIn:!0}))):M(e.data,t)})).catch((function(e){U(e,t)}))}))}}),n=!a.values.email||!a.values.password;return e?Object(G.jsx)(Et.a,{to:"/"}):Object(G.jsxs)(rt.a,{container:!0,justify:"center",children:[Object(G.jsx)(rt.a,{item:!0,children:Object(G.jsx)("form",{onSubmit:a.handleSubmit,children:Object(G.jsxs)(Vt.a,{children:[Object(G.jsxs)(zt.a,{style:{textAlign:"center"},children:[Object(G.jsxs)("p",{children:["To log in get registered",Object(G.jsx)("a",{href:"https://social-network.samuraijs.com/",target:"_blank",children:" here"})]}),Object(G.jsx)("p",{children:"or use common test account credentials:"}),Object(G.jsx)("p",{children:"Email: free@samuraijs.com"}),Object(G.jsx)("p",{children:"Password: free"})]}),Object(G.jsxs)(Mt.a,{children:[Object(G.jsx)(jt.a,Object(v.a)({label:"Email",margin:"normal"},a.getFieldProps("email"))),Object(G.jsx)("div",{className:Ht.a.promptValidation,children:a.errors.email?a.errors.email:""}),Object(G.jsx)(jt.a,Object(v.a)({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),Object(G.jsx)("div",{className:Ht.a.promptValidation,children:a.errors.password?a.errors.password:""}),Object(G.jsx)(Ut.a,{label:"Remember me",control:Object(G.jsx)(Tt.a,Object(v.a)(Object(v.a)({},a.getFieldProps("rememberMe")),{},{checked:a.values.rememberMe}))}),Object(G.jsx)(h.a,{disabled:n,type:"submit",variant:"contained",color:"primary",children:"Login"})]})]})})}),Object(G.jsx)(Q,{})]})};var Wt=function(t){var e=t.demo,a=void 0!==e&&e,i=(Object(r.a)(t,["demo"]),Object(L.c)((function(t){return t.app.status}))),s=Object(L.c)((function(t){return t.app.initialized})),o=Object(L.c)((function(t){return t.auth.isLoggedIn})),c=Object(L.b)();Object(n.useEffect)((function(){c((function(t){z().then((function(e){0===e.data.resultCode?t(R({isLoggedIn:!0})):M(e.data,t),t($({initialized:!0}))})).catch((function(e){U(e,t)}))}))}),[]);var d=Object(n.useCallback)((function(){c((function(t){t(K({status:"loading"})),V().then((function(e){0===e.data.resultCode?(t(K({status:"succeeded"})),t(R({isLoggedIn:!1}))):M(e.data,t)})).catch((function(e){U(e,t)}))}))}),[]);return s?Object(G.jsx)(Nt.a,{children:Object(G.jsxs)("div",{className:l.a.app,children:[Object(G.jsxs)(b.a,{position:"static",className:l.a.headerPosition,children:[Object(G.jsxs)(f.a,{style:{justifyContent:"space-between"},children:[Object(G.jsx)(p.a,{edge:"start",color:"inherit","aria-label":"menu",children:Object(G.jsx)(g.a,{})}),Object(G.jsx)(O.a,{variant:"h6",children:"TodoLists"}),o&&Object(G.jsx)(h.a,{color:"inherit",onClick:d,children:"Log out"})]}),"loading"===i&&Object(G.jsx)(m.a,{className:l.a.linearProgress})]}),Object(G.jsx)(Q,{}),Object(G.jsx)(x.a,{fixed:!0,children:Object(G.jsxs)(Et.d,{children:[Object(G.jsx)(Et.b,{exact:!0,path:"/",render:function(){return Object(G.jsx)(Ft,{demo:a})}}),Object(G.jsx)(Et.b,{path:"/login",render:function(){return Object(G.jsx)(Rt,{})}}),Object(G.jsx)(Et.b,{path:"*",render:function(){return Object(G.jsx)("h1",{children:"PAGE NOT FOUND"})}})]})})]})}):Object(G.jsx)("div",{className:l.a.previewCircularProgress,children:Object(G.jsx)(j.a,{color:"secondary"})})},qt=a(27),Jt=a(52),Kt=Object(qt.b)({todoLists:et,tasks:gt,app:q,auth:H}),Yt=Object(Z.a)({reducer:Kt,middleware:function(t){return t().prepend(Jt.a)}});o.a.render(Object(G.jsx)(L.a,{store:Yt,children:Object(G.jsx)(Wt,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},48:function(t,e,a){t.exports={isDone:"App_isDone__cFwf-",app:"App_app__3M1zD",headerPosition:"App_headerPosition__3VhUp",linearProgress:"App_linearProgress__2Okxf",previewCircularProgress:"App_previewCircularProgress__1pFTr"}},69:function(t,e,a){t.exports={outputSpanContainer:"EditableSpan_outputSpanContainer__3AcMO",textFieldContainer:"EditableSpan_textFieldContainer__3Z4MY"}},70:function(t,e,a){t.exports={taskPosition:"Task_taskPosition__1dZmT",taskDone:"Task_taskDone__1j_LX"}},73:function(t,e,a){t.exports={promptValidation:"Login_promptValidation__3PrWS"}}},[[144,1,2]]]);
//# sourceMappingURL=main.db2dda83.chunk.js.map